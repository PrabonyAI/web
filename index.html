import React, { useState, useEffect, useRef } from 'react';
import { 
  Moon, Sun, ArrowRight, Zap, Code, Cpu, 
  Github, Download, Clock, MessageSquare, CreditCard,
  Rocket, GraduationCap, Store, Briefcase, UserCheck, Building2,
  ChevronDown, ChevronUp, Mail, Sparkles,
  Youtube, Instagram, Linkedin
} from 'lucide-react';

// Custom X Logo Component (since Lucide 'X' is a cross, and 'Twitter' is the bird)
const XLogo = ({ size = 20, className }) => (
  <svg 
    xmlns="http://www.w3.org/2000/svg" 
    width={size} 
    height={size} 
    viewBox="0 0 24 24" 
    fill="currentColor" 
    className={className}
  >
    <path d="M18.901 1.153h3.68l-8.04 9.19L24 22.846h-7.406l-5.8-7.584-6.638 7.584H.474l8.6-9.83L0 1.154h7.594l5.243 6.932ZM17.61 20.644h2.039L6.486 3.24H4.298Z" />
  </svg>
);

// Utility component for counting up numbers
const CountUp = ({ end, duration = 2000 }) => {
  const [count, setCount] = useState(0);
  const countRef = useRef(null);
  const [isVisible, setIsVisible] = useState(false);

  useEffect(() => {
    const observer = new IntersectionObserver(
      ([entry]) => {
        if (entry.isIntersecting) {
          setIsVisible(true);
        }
      },
      { threshold: 0.1 }
    );

    if (countRef.current) {
      observer.observe(countRef.current);
    }

    return () => observer.disconnect();
  }, []);

  useEffect(() => {
    if (!isVisible) return;

    let startTime = null;
    const animate = (currentTime) => {
      if (!startTime) startTime = currentTime;
      const progress = Math.min((currentTime - startTime) / duration, 1);
      
      // Easing function for smooth counting
      const easeOutQuart = 1 - Math.pow(1 - progress, 4);
      
      setCount(Math.floor(easeOutQuart * end));

      if (progress < 1) {
        requestAnimationFrame(animate);
      }
    };

    requestAnimationFrame(animate);
  }, [isVisible, end, duration]);

  return <span ref={countRef}>{count.toLocaleString()}</span>;
};

const LandingPage = () => {
  const [darkMode, setDarkMode] = useState(true);
  const [mousePosition, setMousePosition] = useState({ x: 0, y: 0 });
  const [cursorVariant, setCursorVariant] = useState("default");
  const [openFaq, setOpenFaq] = useState(null);
  const [stars, setStars] = useState([]);

  // Toggle theme handler
  const toggleTheme = () => {
    setDarkMode(!darkMode);
  };

  const toggleFaq = (index) => {
    setOpenFaq(openFaq === index ? null : index);
  };

  // Generate Space Stars
  useEffect(() => {
    const generateStars = () => {
      return Array.from({ length: 150 }).map((_, i) => ({
        id: i,
        left: `${Math.random() * 100}%`,
        top: `${Math.random() * 100}%`,
        size: Math.random() > 0.9 ? Math.random() * 3 + 2 : Math.random() * 2 + 1, // 10% larger stars
        animationDuration: `${Math.random() * 4 + 3}s`, // Slower, majestic twinkle
        animationDelay: `${Math.random() * 5}s`,
        type: Math.random() > 0.92 ? 'burning' : 'standard' // 8% are "burning" stars
      }));
    };
    setStars(generateStars());
  }, []);

  // Mouse move effect & Custom Cursor
  useEffect(() => {
    const handleMouseMove = (e) => {
      setMousePosition({
        x: e.clientX,
        y: e.clientY,
      });
      
      // Check if hovering over clickable elements for cursor effect
      const hoveredElement = document.elementFromPoint(e.clientX, e.clientY);
      if (hoveredElement) {
        const isClickable = hoveredElement.closest('a') || 
                           hoveredElement.closest('button') || 
                           hoveredElement.closest('.interactive');
        setCursorVariant(isClickable ? "hover" : "default");
      }
    };

    window.addEventListener('mousemove', handleMouseMove);
    return () => window.removeEventListener('mousemove', handleMouseMove);
  }, []);

  const features = [
    {
      icon: <CreditCard size={32} />,
      title: "90 Websites for Free",
      desc: "Get 3 Free Credits daily. That's up to 90 websites a month without spending a dime."
    },
    {
      icon: <Github size={32} />,
      title: "One-Click GitHub Push",
      desc: "Seamlessly push your generated code to your GitHub repository instantly."
    },
    {
      icon: <Download size={32} />,
      title: "Full Code Ownership",
      desc: "Download the complete source code. It's clean, readable, and yours to keep."
    },
    {
      icon: <Clock size={32} />,
      title: "Build in < 120 Seconds",
      desc: "From idea to deployed website in under two minutes. Speed is our currency."
    },
    {
      icon: <MessageSquare size={32} />,
      title: "Chat to Edit",
      desc: "Need changes? Just chat. 'Make the button blue', 'Add a contact form' - done."
    },
    {
      icon: <Zap size={32} />,
      title: "Instant Deploy",
      desc: "Go live immediately. Share your creation with the world with a single link."
    }
  ];

  const useCases = [
    {
      icon: <Rocket size={24} />,
      role: "Startup Founders",
      desc: "Don't know how to code? Kickstart your MVP with BadCoder and launch fast."
    },
    {
      icon: <GraduationCap size={24} />,
      role: "Students",
      desc: "Build impressive projects for your portfolio or hackathons instantly."
    },
    {
      icon: <Store size={24} />,
      role: "Small Business",
      desc: "Go digital today. No tech skills needed. Just chat and get your business online."
    },
    {
      icon: <Briefcase size={24} />,
      role: "Professionals",
      desc: "Build beautiful personal websites or landing pages to showcase your work."
    },
    {
      icon: <UserCheck size={24} />,
      role: "Freelancers",
      desc: "Deliver client projects faster and build your own portfolio in minutes."
    },
    {
      icon: <Building2 size={24} />,
      role: "Agency Owners",
      desc: "Scale your output. Build for clients with a single prompt and maximize margins."
    }
  ];

  const faqs = [
    {
      q: "Is it really free?",
      a: "Yes! You get 3 free credits every single day. You can build up to 90 websites a month completely for free."
    },
    {
      q: "Do I own the code?",
      a: "Absolutely. You can download the full source code or push it to your GitHub. You own what you build."
    },
    {
      q: "What tech stack does it use?",
      a: "BadCoder generates minimal, easy-to-understand HTML, CSS, and JavaScript code that is production-ready."
    },
    {
      q: "Can I edit the website after generating?",
      a: "Yes. Our 'Chat to Edit' feature allows you to refine your website using natural language commands."
    },
    {
      q: "Is it suitable for production apps?",
      a: "BadCoder builds excellent front-end foundations, landing pages, and single-page applications ready for deployment."
    }
  ];

  const analytics = [
    { label: "Users", value: 3500 },
    { label: "Websites Built", value: 2000 },
    { label: "Prompts Sent", value: 5000 },
    { label: "Github Repos Pushed", value: 1000 },
  ];

  const socialLinks = [
    { icon: <Youtube size={20} />, href: "https://www.youtube.com/@PrabonyAI" },
    { icon: <Instagram size={20} />, href: "https://www.instagram.com/prabony.ai?utm_source=ig_web_button_share_sheet&igsh=ZDNlZDc0MzIxNw==" },
    { icon: <Linkedin size={20} />, href: "https://www.linkedin.com/company/prabonyai/" },
    { icon: <XLogo size={20} />, href: "https://x.com/prabonyAI" }, // Replaced with custom X component
  ];

  return (
    <div className={`min-h-screen transition-colors duration-1000 ease-in-out font-['Poppins'] ${darkMode ? 'bg-[#050510] text-white' : 'bg-gray-50 text-gray-900'} overflow-x-hidden cursor-none`}>
      {/* Font & Styles Import */}
      <style>
        {`
          @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
          @import url('https://fonts.googleapis.com/css2?family=Unbounded:wght@400;600;700&display=swap');
          
          .ambient-light {
            position: absolute;
            border-radius: 50%;
            filter: blur(80px);
            z-index: 0;
            opacity: 0.5;
            transition: all 1s ease;
          }
          
          /* Custom scrollbar */
          ::-webkit-scrollbar {
            width: 8px;
          }
          ::-webkit-scrollbar-track {
            background: ${darkMode ? '#050510' : '#f9fafb'};
          }
          ::-webkit-scrollbar-thumb {
            background: ${darkMode ? '#333' : '#ccc'};
            border-radius: 4px;
          }

          /* Reveal Glow Animation */
          @keyframes revealGlow {
            0% { opacity: 0.3; transform: translateY(20px) scale(0.95); }
            50% { opacity: 0.6; transform: translateY(0) scale(1); }
            100% { opacity: 0.3; transform: translateY(20px) scale(0.95); }
          }
          .animate-reveal {
            animation: revealGlow 4s infinite ease-in-out;
          }

          /* Star Animations */
          @keyframes twinkle {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.2); }
          }
          
          @keyframes burn {
            0%, 100% { opacity: 0.4; transform: scale(1); box-shadow: 0 0 2px rgba(255, 255, 255, 0.2); }
            50% { opacity: 1; transform: scale(1.5); box-shadow: 0 0 15px rgba(255, 255, 255, 0.8), 0 0 30px rgba(120, 100, 255, 0.4); }
          }

          .star {
            position: absolute;
            border-radius: 50%;
            background-color: white;
            z-index: 0;
          }
        `}
      </style>

      {/* Custom Cursor Lens */}
      <div 
        className="fixed pointer-events-none z-[100] rounded-full transition-all duration-300 ease-out flex items-center justify-center mix-blend-difference"
        style={{
          left: mousePosition.x,
          top: mousePosition.y,
          width: '30px',
          height: '30px',
          transform: `translate(-50%, -50%) scale(${cursorVariant === 'hover' ? 3 : 1})`,
          backgroundColor: cursorVariant === 'hover' ? 'white' : 'transparent',
          border: '1px solid rgba(255,255,255,0.5)'
        }}
      />

      {/* BACKGROUND CONTAINER */}
      <div className="fixed inset-0 overflow-hidden pointer-events-none z-0">
        
        {/* Dark Mode: Starry Universe */}
        <div className={`absolute inset-0 transition-opacity duration-1000 ${darkMode ? 'opacity-100' : 'opacity-0'}`}>
           {/* Deep Space Gradient Base */}
           <div className="absolute inset-0 bg-gradient-to-b from-[#020205] via-[#050510] to-[#0a0a20]" />
           
           {/* Nebula Effects */}
           <div className="absolute top-0 left-0 w-full h-full opacity-30 bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-blue-900/40 via-transparent to-transparent" />
           <div className="absolute bottom-0 right-0 w-full h-full opacity-20 bg-[radial-gradient(ellipse_at_bottom_right,_var(--tw-gradient-stops))] from-purple-900/40 via-transparent to-transparent" />

           {/* Generated Stars */}
           {stars.map((star) => (
             <div 
                key={star.id}
                className="star"
                style={{
                  left: star.left,
                  top: star.top,
                  width: `${star.size}px`,
                  height: `${star.size}px`,
                  animationName: star.type === 'burning' ? 'burn' : 'twinkle',
                  animationDuration: star.animationDuration,
                  animationDelay: star.animationDelay,
                  animationIterationCount: 'infinite',
                  animationTimingFunction: 'ease-in-out',
                }}
             />
           ))}
        </div>

        {/* Light Mode: Clean Minimal Ambience */}
        <div className={`absolute inset-0 transition-opacity duration-1000 ${darkMode ? 'opacity-0' : 'opacity-100'}`}>
          <div 
            className="ambient-light w-96 h-96 opacity-30 transition-transform duration-100 ease-out"
            style={{
              background: 'radial-gradient(circle, rgba(99, 102, 241, 0.1) 0%, rgba(255,255,255,0) 70%)',
              left: `${(mousePosition.x / window.innerWidth) * 100}%`,
              top: `${(mousePosition.y / window.innerHeight) * 100}%`,
              transform: 'translate(-50%, -50%)'
            }}
          />
          <div className="ambient-light top-0 left-0 w-[600px] h-[600px] -translate-x-1/3 -translate-y-1/3 bg-blue-300/20" />
          <div className="ambient-light bottom-0 right-0 w-[800px] h-[800px] translate-x-1/3 translate-y-1/3 bg-purple-300/20" />
        </div>

      </div>

      {/* Navigation */}
      <nav className={`fixed w-full z-50 transition-all duration-300 backdrop-blur-md ${darkMode ? 'bg-black/20 border-b border-white/5' : 'bg-white/70 border-b border-black/5'}`}>
        <div className="max-w-7xl mx-auto px-6 py-5 flex justify-between items-center">
          <div className="flex items-center gap-2 group cursor-pointer interactive">
            <span className={`font-['Unbounded'] font-semibold text-xl tracking-tight transition-colors ${darkMode ? 'text-white' : 'text-gray-900'}`}>
              <a href="www.prabonyai.in">Prabony AI</a>
            </span>
          </div>
          
          <button 
            onClick={toggleTheme}
            className={`interactive p-3 rounded-full transition-all duration-300 hover:scale-110 active:scale-95 ${darkMode ? 'bg-white/10 hover:bg-white/20 text-yellow-300' : 'bg-black/5 hover:bg-black/10 text-slate-700'}`}
            aria-label="Toggle Theme"
          >
            {darkMode ? <Sun size={20} /> : <Moon size={20} />}
          </button>
        </div>
      </nav>

      {/* Main Content Container */}
      <div className="relative z-10 max-w-7xl mx-auto px-6 pt-32 pb-20">
        
        {/* HERO SECTION */}
        <section className="min-h-[80vh] flex flex-col items-center justify-center text-center mb-16">
          
          <div className={`mb-8 px-4 py-1.5 rounded-full text-sm font-medium tracking-wide animate-fade-in-up flex items-center gap-2 border ${darkMode ? 'border-white/10 bg-white/5 text-blue-300' : 'border-black/10 bg-black/5 text-blue-700'}`}>
            <span className="relative flex h-2 w-2">
              <span className="animate-ping absolute inline-flex h-full w-full rounded-full bg-blue-400 opacity-75"></span>
              <span className="relative inline-flex rounded-full h-2 w-2 bg-blue-500"></span>
            </span>
            Prabony AI
          </div>

          <h1 className={`text-5xl md:text-7xl lg:text-8xl font-semibold tracking-tight leading-tight mb-8 flex items-center justify-center flex-wrap gap-2 ${darkMode ? 'text-white' : 'text-gray-900'}`}>
            <span>Introducing BadCoder</span>
  
          </h1>

          <p className={`text-xl md:text-2xl font-light max-w-2xl mx-auto leading-relaxed mb-10 ${darkMode ? 'text-gray-300' : 'text-gray-600'}`}>
            Build websites with one prompt.
            <br />
            <span className="text-lg opacity-80 mt-2 block">Minimalist. Powerful. Instant.</span>
          </p>

          <div className="group">
            <a 
              href="https://www.badcoder.in" 
              target="_blank" 
              rel="noopener noreferrer"
              className="interactive relative inline-flex items-center gap-4 px-8 h-[60px] text-lg font-semibold rounded-full transition-all duration-300 scale-[0.7] hover:scale-[0.75] hover:tracking-wide overflow-hidden shadow-lg hover:shadow-blue-500/25 origin-top"
            >
              <div className={`absolute inset-0 transition-opacity duration-300 ${darkMode ? 'bg-white text-black hover:bg-gray-200' : 'bg-black text-white hover:bg-gray-800'}`} />
              <span className={`relative z-10 flex items-center gap-2 ${darkMode ? 'text-black' : 'text-white'}`}>
                Get Started
                <ArrowRight size={20} />
              </span>
            </a>
          </div>
        </section>

        {/* ANALYTICS SECTION */}
        <section className="py-16 mb-20 border-y border-white/5">
           <div className="grid grid-cols-2 md:grid-cols-4 gap-8 text-center">
             {analytics.map((item, index) => (
               <div key={index} className="space-y-2 scale-[0.7] origin-center">
                 <div className={`text-4xl md:text-5xl font-medium ${darkMode ? 'text-white' : 'text-gray-900'}`}>
                   <CountUp end={item.value} />+
                 </div>
                 <div className={`text-sm uppercase tracking-wider font-medium ${darkMode ? 'text-blue-400/80' : 'text-blue-600'}`}>
                   {item.label}
                 </div>
               </div>
             ))}
           </div>
        </section>

        {/* FEATURES SECTION */}
        <section className="py-24 mb-20">
          <div className="text-center mb-20">
            <h2 className={`text-3xl md:text-5xl font-semibold mb-6 ${darkMode ? 'text-white' : 'text-gray-900'}`}>
              Why use BadCoder?
            </h2>
            <p className={`text-lg max-w-2xl mx-auto ${darkMode ? 'text-gray-300' : 'text-gray-600'}`}>
              Everything you need to go from idea to deployment in seconds.
            </p>
          </div>

          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            {features.map((feature, idx) => (
              <div 
                key={idx} 
                className={`interactive p-8 rounded-2xl transition-all duration-300 border backdrop-blur-sm group hover:-translate-y-2
                  ${darkMode 
                    ? 'bg-white/5 border-white/10 hover:bg-white/10 hover:border-blue-500/30' 
                    : 'bg-white border-black/5 shadow-lg hover:shadow-xl'
                  }`}
              >
                <div className={`mb-6 p-3 rounded-xl inline-block ${darkMode ? 'bg-blue-500/20 text-blue-300' : 'bg-blue-100 text-blue-600'}`}>
                  {feature.icon}
                </div>
                <h3 className={`text-xl font-semibold mb-3 ${darkMode ? 'text-white' : 'text-gray-900'}`}>
                  {feature.title}
                </h3>
                <p className={`leading-relaxed ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>
                  {feature.desc}
                </p>
              </div>
            ))}
          </div>
        </section>

        {/* USE CASES SECTION */}
        <section className="py-24 mb-20">
          <div className="flex flex-col md:flex-row items-end justify-between mb-16 gap-6">
            <div className="max-w-xl">
              <h2 className={`text-3xl md:text-5xl font-semibold mb-6 ${darkMode ? 'text-white' : 'text-gray-900'}`}>
                Built for Everyone
              </h2>
              <p className={`text-lg ${darkMode ? 'text-gray-300' : 'text-gray-600'}`}>
                Whether you are just starting or scaling an agency, BadCoder adapts to your workflow.
              </p>
            </div>
          </div>

          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {useCases.map((useCase, idx) => (
              <div 
                key={idx}
                className={`interactive p-6 rounded-xl border transition-all duration-300 
                  ${darkMode 
                    ? 'bg-transparent border-white/10 hover:bg-blue-500/10' 
                    : 'bg-transparent border-black/10 hover:bg-blue-50'
                  }`}
              >
                <div className="flex items-center gap-3 mb-4">
                  <div className={darkMode ? 'text-blue-400' : 'text-blue-600'}>
                    {useCase.icon}
                  </div>
                  <h4 className={`text-lg font-semibold ${darkMode ? 'text-white' : 'text-gray-900'}`}>
                    {useCase.role}
                  </h4>
                </div>
                <p className={`text-sm leading-relaxed ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>
                  {useCase.desc}
                </p>
              </div>
            ))}
          </div>
        </section>

        {/* FAQ SECTION */}
        <section className="py-24 max-w-3xl mx-auto mb-20">
          <h2 className={`text-3xl md:text-5xl font-semibold text-center mb-16 ${darkMode ? 'text-white' : 'text-gray-900'}`}>
            Frequently Asked Questions
          </h2>
          
          <div className="space-y-4">
            {faqs.map((faq, idx) => (
              <div 
                key={idx} 
                className={`interactive border rounded-2xl overflow-hidden transition-all duration-300 ${darkMode ? 'border-white/10 bg-white/5' : 'border-black/5 bg-white'}`}
              >
                <button 
                  onClick={() => toggleFaq(idx)}
                  className="w-full flex items-center justify-between p-6 text-left focus:outline-none"
                >
                  <span className={`text-lg font-medium ${darkMode ? 'text-white' : 'text-gray-900'}`}>
                    {faq.q}
                  </span>
                  {openFaq === idx ? <ChevronUp size={20} /> : <ChevronDown size={20} />}
                </button>
                <div 
                  className={`overflow-hidden transition-all duration-300 ease-in-out ${openFaq === idx ? 'max-h-40 opacity-100' : 'max-h-0 opacity-0'}`}
                >
                  <div className={`p-6 pt-0 ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>
                    {faq.a}
                  </div>
                </div>
              </div>
            ))}
          </div>
        </section>

        {/* FUTURE PRODUCTS REVEAL */}
        <section className="py-32 relative overflow-hidden flex flex-col items-center justify-center">
            {/* Glowing Floor - Adjusted Radius - REMOVED */}
            
            <div className="relative z-10 text-center space-y-4">
              {/* Tab - Translated Up */}
              <div 
                className={`inline-flex items-center gap-2 px-4 py-2 rounded-full border text-sm font-medium transform -translate-y-[50px]
                ${darkMode ? 'border-blue-500/30 text-blue-300 bg-blue-500/10' : 'border-blue-500/30 text-blue-600 bg-blue-50'}`}
              >
                <Sparkles size={16} />
                <span>The Future Awaits</span>
              </div>
              <h2 className={`text-5xl md:text-7xl font-bold tracking-tighter opacity-90 ${darkMode ? 'text-transparent bg-clip-text bg-gradient-to-b from-white to-white/10' : 'text-transparent bg-clip-text bg-gradient-to-b from-gray-900 to-gray-400'}`}>
                Something New <br/> Is Coming
              </h2>
            </div>
        </section>

        {/* ABOUT & CONTACT SECTION */}
        <section className="py-20 text-center border-t border-opacity-10 border-gray-500">
          <div className={`inline-block p-4 rounded-full mb-8 ${darkMode ? 'bg-white/5' : 'bg-black/5'}`}>
            <Cpu size={48} className={`mx-auto ${darkMode ? 'text-blue-400' : 'text-blue-600'}`} />
          </div>
          
          <h2 className={`text-3xl md:text-4xl font-semibold mb-6 ${darkMode ? 'text-white' : 'text-gray-900'}`}>
            About Prabony AI
          </h2>
          
          <div className={`max-w-3xl mx-auto text-lg leading-relaxed space-y-6 mb-12 ${darkMode ? 'text-gray-300' : 'text-gray-600'}`}>
            <p>
              Prabony AI launched <span className="font-semibold text-blue-500">BadCoder</span> with a singular vision.
            </p>
            <p>
              Our mission is to establish India as a global leader on the stage of Artificial Intelligence. 
              We believe in the power of technology to simplify existence. Our purpose is to build products that 
              make people's lives easier, simpler, and more creative through the power of AI.
            </p>
          </div>

          {/* Minimal Contact Info */}
          <div className={`flex items-center justify-center gap-2 text-sm md:text-base mb-8 transition-colors ${darkMode ? 'text-gray-500 hover:text-white' : 'text-gray-500 hover:text-black'}`}>
             <Mail size={16} />
             <a href="mailto:info@prabonyai.in" className="interactive border-b border-transparent hover:border-current transition-all">
               info@prabonyai.in
             </a>
          </div>
          
           {/* Social Media Links */}
           <div className="flex justify-center items-center gap-6">
            {socialLinks.map((social, idx) => (
              <a 
                key={idx} 
                href={social.href}
                target="_blank"
                rel="noopener noreferrer"
                className={`interactive p-2 rounded-full transition-all duration-300 hover:-translate-y-1 
                  ${darkMode 
                    ? 'text-gray-400 hover:text-white hover:bg-white/10' 
                    : 'text-gray-500 hover:text-black hover:bg-black/5'
                  }`}
              >
                {social.icon}
              </a>
            ))}
          </div>
        </section>

        {/* Footer */}
        <footer className={`py-8 text-center text-sm ${darkMode ? 'text-gray-600' : 'text-gray-400'}`}>
          <p>Â© {new Date().getFullYear()} Prabony AI. All rights reserved.</p>
        </footer>

      </div>
    </div>
  );
};

export default LandingPage;
